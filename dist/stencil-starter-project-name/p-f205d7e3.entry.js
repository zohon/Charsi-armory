import{r as i,h as t,H as e,g as a,a as s}from"./p-31265a07.js";import{f as n,c as o,A as r}from"./p-9ad31d03.js";var l={compareTwoStrings:c,findBestMatch:function(i,t){if(!function(i,t){return"string"==typeof i&&!!Array.isArray(t)&&!!t.length&&!t.find((function(i){return"string"!=typeof i}))}(i,t))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const e=[];let a=0;for(let s=0;s<t.length;s++){const n=t[s],o=c(i,n);e.push({target:n,rating:o}),o>e[a].rating&&(a=s)}return{ratings:e,bestMatch:e[a],bestMatchIndex:a}}};function c(i,t){if((i=i.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(i.length<2||t.length<2)return 0;let e=new Map;for(let t=0;t<i.length-1;t++){const a=i.substring(t,t+2),s=e.has(a)?e.get(a)+1:1;e.set(a,s)}let a=0;for(let i=0;i<t.length-1;i++){const s=t.substring(i,i+2),n=e.has(s)?e.get(s):0;n>0&&(e.set(s,n-1),a++)}return 2*a/(i.length+t.length-2)}const h=class{constructor(t){i(this,t),this.uniqs=[],this.holyGrail=[],this.search="",this.searchHoly=!1,this.listening=!1,this.percent=0,this.listImg=[],this.baseItem=[{base:"doubleaxe",other:["doubleaxe","ettinaxe","twinaxe"]},{base:"militarypick",other:["warspike","crowbill","militarypick"]},{base:"waraxe",other:["naga","waraxe","berserkeraxe"]},{base:"largeaxe",other:["militaryaxe","largeaxe","feralaxe"]},{base:"broadaxe",other:["beardedaxe","broadaxe","silver-edgedaxe"]},{base:"greataxe",other:["gothicaxe","greataxe","championaxe"]},{base:"wand",other:["burntwand","polishedwand","wand"]},{base:"bonewand",other:["tombwand","lichwand","bonewand"]}]}componentWillLoad(){this.getHolyGrail(),this.getUniqs(),this.manageVoice()}manageVoice(){const i=window.speechRecognition||window.webkitSpeechRecognition;this.recognition=new i,this.recognition.continuous=!0,this.recognition.lang="en-EN",this.recognition.onresult=i=>{for(let t=i.resultIndex;t<i.results.length;t++)this.manageCommand(i.results[t][0].transcript)}}manageCommand(i){var t;if(console.log(i),i.includes("search")&&(this.search=i.replace("search","").trim(),console.log(this.search)),i.includes("select first")){const i=this.filterList(this.uniqs);(null===(t=null==i?void 0:i[0])||void 0===t?void 0:t.id)&&this.setHolyGrail(i[0].id)}}async getUniqs(){var i;null===(i=n(r.Uniq))||void 0===i||i.then((i=>{var t;this.uniqs=o(i),null===(t=n(r.Set))||void 0===t||t.then((i=>this.uniqs=[...this.uniqs,...o(i)])).then((i=>{console.log(i.map((i=>{if(i.type){const t=i.type.toLowerCase().replace(/'/g,"").replace(/ /g,"").trim();return{label:t,src:`https://diablo2.io/styles/zulu/theme/images/items/${t}_graphic.png`}}})))}))}))}handleChange(i){this.search=i.target.value}getHolyGrail(){const i=localStorage.getItem("holyGrail");if(i)try{this.holyGrail=JSON.parse(i)}catch(i){console.log("WTF holy grail")}}setHolyGrail(i,t=!1,e=!0){var a,s,n,o;let r=this.holyGrail.find((({id:t})=>i===t));r?r.ethereal!==t?r=Object.assign(Object.assign({},r),{ethereal:t}):this.holyGrail=this.holyGrail.filter((({id:t})=>t!==i)):this.holyGrail.push({id:i,ethereal:t,exist:e}),this.holyGrail=[...this.holyGrail],localStorage.setItem("holyGrail",JSON.stringify(this.holyGrail)),null===(s=null===(a=this.element.querySelectorAll("input"))||void 0===a?void 0:a[0])||void 0===s||s.focus(),null===(o=null===(n=this.element.querySelectorAll("input"))||void 0===n?void 0:n[0])||void 0===o||o.select()}filterList(i){return i.filter((({id:i,"lvl req":t})=>{if(i&&t)return!(this.searchHoly&&!this.isHolyGrail(i))&&(i=this.manageId(i),!this.search||l.compareTwoStrings(i,this.search)>this.percent||void 0)})).sort(((i,t)=>{const e=this.manageId(i.id),a=this.manageId(t.id);return l.compareTwoStrings(a,this.search)-l.compareTwoStrings(e,this.search)}))}manageId(i){return i.toLowerCase().replace("the","")}isHolyGrail(i){return this.holyGrail.find((({id:t})=>t===i))}render(){return t(e,null,t("div",{class:"close"}),t("div",{class:"header"},"HOLY GRAIL [",this.holyGrail.length,"/",this.uniqs.length,"] (üèÜ",Math.round(this.holyGrail.length/this.uniqs.length*1e4)/100,"%)"),t("div",{class:"actions"},t("input",{list:"list-uniq",value:this.search,onInput:i=>{this.handleChange(i)},placeholder:"Item name"}),t("div",{class:{on:this.searchHoly,action:!0},onClick:()=>this.searchHoly=!this.searchHoly},"üèÜ"),t("div",{class:{on:this.listening,action:!0},onClick:()=>{this.listening?(this.recognition.stop(),this.listening=!1):(this.recognition.start(),this.listening=!0)}},"üé§")),t("div",{class:"list"},this.filterList(this.uniqs).map((({id:i,value:e,"lvl req":a,type:s})=>{const n=this.isHolyGrail(i);return t("div",{key:i,class:{grailed:!!n,uniq:!0},onClick:()=>this.setHolyGrail(i)},this.displayimg(i,s),t("div",{class:"infos"},t("div",{class:"name"},i),t("div",{class:"type"},s),t("div",{class:"lvl"},a)),t("div",{class:"value"},e),t("div",{class:"holyGrail"},n?n.ethereal?"üèÜ<Ethereal>":"üèÜ":""))}))))}reduceType(i){return i.toLowerCase().replace(/'/g,"").replace(/ /g,"").trim()}getBaseType(i){var t;const e=this.reduceType(i);return(null===(t=this.baseItem.find((({other:i})=>i.includes(e))))||void 0===t?void 0:t.base)||e}manageErrorImg(i,t){const e=this.getBaseType(t),s=a(`./assets/img/${e}.png`);i.target.src.includes(`/${e}.png`)?i.target.remove():i.target.src=s}displayimg(i,e){const s=i.toLowerCase().replace(/'/g,"").replace(/ /g,"").trim();return t("div",{class:"img"},t("img",{onError:i=>this.manageErrorImg(i,e),src:a(`./assets/img/${s}.png`),loading:"lazy"}))}static get assetsDirs(){return["assets"]}get element(){return s(this)}};h.style='@charset "UTF-8";ca-uniq{display:block;color:#8c8875;font-family:"formal";border:1px solid #8c8875;padding:0 1px;position:relative}ca-uniq .close{position:absolute;top:1px;right:1px;height:24px;font-size:24px;width:23px;color:#cd0202;border:2px solid black;display:flex;background:#850707;justify-content:center;align-items:center;cursor:pointer}ca-uniq .close:hover{filter:brightness(1.75)}ca-uniq .close:before{content:"X";text-shadow:1px 1px 1px black}ca-uniq .header{font-family:"exocet_big";font-size:24px;height:45px;display:flex;align-items:center;padding:0 15px}ca-uniq .actions{margin:10px 0px;display:flex;padding:0 15px}ca-uniq .action{border:1px solid #8c8875;color:#8c8875;display:flex;justify-content:center;align-items:center;padding:5px;margin:0 5px;cursor:pointer;user-select:none}ca-uniq .action.on{background-color:#8c8875;color:black}ca-uniq input{border:1px solid #8c8875;background:none;color:#8c8875;font-family:"exocet_big";font-size:16px;padding:5px 10px;outline:none;width:auto}ca-uniq input:focus{border:2px solid #8c8875}ca-uniq input option{background-color:red}ca-uniq .list{height:calc(100% - 99px);overflow:auto;display:grid;grid-template-columns:repeat(5, 1fr);grid-column-gap:15px;padding:0 15px;grid-row-gap:15px;}ca-uniq .list::-webkit-scrollbar{width:10px}ca-uniq .list::-webkit-scrollbar-track{background:#8c8875}ca-uniq .list::-webkit-scrollbar-thumb{background:#24150b}ca-uniq .list::-webkit-scrollbar-thumb:hover{background:#555}ca-uniq .uniq{display:flex;cursor:pointer;transition:font-size 0.3s ease;flex-direction:column;height:250px;align-items:center;border:1px solid #000;text-align:center;position:relative;filter:grayscale(1);background:#2c2c2c;align-items:center;box-shadow:inset 0px 0px 6px 6px #0000001c;z-index:100}ca-uniq .uniq.grailed{border:1px solid #8c8875;filter:grayscale(0)}ca-uniq .uniq .img{transition:all 0.3s ease-in-out;height:100%;margin-bottom:30px;display:flex;align-items:center}ca-uniq .uniq .img img{object-fit:contain}ca-uniq .uniq .infos{background-color:rgba(0, 0, 0, 0.2);position:absolute;bottom:0;width:100%;padding:15px 0}ca-uniq .uniq .lvl{display:none}ca-uniq .uniq .holyGrail{position:absolute;text-align:right;width:100%;top:5px;right:5px}ca-uniq .uniq .type{min-width:120px;color:#6a6a6a}ca-uniq .uniq:hover{background-color:black}ca-uniq .uniq .value{margin:0 5px}ca-uniq .uniq .value:not(:empty):after{content:"üí∞"}';export{h as ca_uniq}